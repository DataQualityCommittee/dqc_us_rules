language: python
python:
  - "3.4"
branches:
  only: 
  - master
  - /next.*/
env:
  global:
    - TESTCASESROOT=./DQC_Testcases
    - CURRDIR=$(pwd)
    - FILENUMBER=''
  matrix:
    - TESTCASE=DQC_0065	
install:
  - pip install -r requirements.txt
script:
  - OUTPUTLOGFILE=./$TESTCASE-log.xml
  - OUTPUTERRFILE=./$TESTCASE-err.txt
  - OUTPUTCSVFILE=./$TESTCASE-report.csv
  - python3.4 -m arelle.CntlrCmdLine --file "$TESTCASESROOT/$TESTCASE/variation$FILENUMBER.xml" --validate --plugins "$CURRDIR/xule|logging/dqcParameters.py" --csvTestReport "$OUTPUTCSVFILE" --logFile "$OUTPUTLOGFILE" --xule-test-debug
  - python3.4 ./scan_results.py $OUTPUTCSVFILE
after_script:
  # Copy the test report to the log
  - echo '===== START TEST RPOERT FILE (csv) =====' && cat $OUTPUTCSVFILE && echo '===== END TEST RPOERT FILE (csv) ====='
  - echo '===== START LOG FILE =====' && cat $OUTPUTLOGFILE && echo '===== END LOG FILE ====='

