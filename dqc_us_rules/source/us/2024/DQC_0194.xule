/**
DQC Rules
 (c) Copyright 2017 - 2024, XBRL US Inc. All rights reserved.
 See https://xbrl.us/dqc-license for license information.
 See https://xbrl.us/dqc-patent for patent infringement notice.
Taxonomy: US GAAP ALL

**/

RULE-NAME-PREFIX DQC


/** CHECK FORMAT OF DIVIDEND MEMBER  of yearperiodMember**/

ASSERT US.0194.10621 satisfied

$rule_id = (rule-name().split('.'))[rule-name().split('.').length];

/** LOok at allowable values for common stock **/

$Common_Stock_Positive = set(SharesOutstanding, 
                                    CommonStockSharesOutstanding, 
                                    StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest,
                                    StockIssuedDuringPeriodValueNewIssues,
                                    StockIssuedDuringPeriodSharesNewIssues,
                                    StockIssuedDuringPeriodValueIssuedForServices,
                                    StockIssuedDuringPeriodSharesIssuedForServices,
                                    StockGrantedDuringPeriodValueSharebasedCompensationGross,
                                    StockGrantedDuringPeriodValueSharebasedCompensationForfeited,
                                    StockGrantedDuringPeriodValueSharebasedCompensation,
                                    ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsGrantsInPeriodGross,
                                    ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsForfeituresInPeriod,
                                    ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsGrantsInPeriod,
                                    StockIssuedDuringPeriodValueShareBasedCompensationGross,
                                    StockIssuedDuringPeriodValueShareBasedCompensationForfeited,
                                    StockIssuedDuringPeriodValueShareBasedCompensation,
                                    StockIssuedDuringPeriodSharesShareBasedCompensationGross,
                                    StockIssuedDuringPeriodSharesShareBasedCompensationForfeited,
                                    StockIssuedDuringPeriodSharesShareBasedCompensation,
                                    StockIssuedDuringPeriodValueRestrictedStockAwardGross,
                                    StockIssuedDuringPeriodValueRestrictedStockAwardForfeitures,
                                    StockIssuedDuringPeriodValueRestrictedStockAwardNetOfForfeitures,
                                    StockIssuedDuringPeriodSharesRestrictedStockAwardGross,
                                    StockIssuedDuringPeriodSharesRestrictedStockAwardForfeited,
                                    StockIssuedDuringPeriodSharesRestrictedStockAwardNetOfForfeitures,
                                    StockIssuedDuringPeriodValueStockOptionsExercised,
                                    StockIssuedDuringPeriodSharesStockOptionsExercised,
                                    StockIssuedDuringPeriodValueEmployeeStockOwnershipPlan,
                                    StockIssuedDuringPeriodSharesEmployeeStockOwnershipPlan,
                                    StockIssuedDuringPeriodValueEmployeeStockPurchasePlan,
                                    StockIssuedDuringPeriodSharesEmployeeStockPurchasePlans,
                                    StockIssuedDuringPeriodValueEmployeeBenefitPlan,
                                    StockIssuedDuringPeriodSharesEmployeeBenefitPlan,
                                    StockIssuedDuringPeriodValueAcquisitions,
                                    StockIssuedDuringPeriodSharesAcquisitions,
                                    StockIssuedDuringPeriodValueConversionOfConvertibleSecurities,
                                    StockIssuedDuringPeriodSharesConversionOfConvertibleSecurities,
                                    StockIssuedDuringPeriodValueConversionOfConvertibleSecuritiesNetOfAdjustments,
                                    StockIssuedDuringPeriodValueConversionOfUnits,
                                    StockIssuedDuringPeriodSharesConversionOfUnits,
                                    StockIssuedDuringPeriodValueStockDividend,
                                    CommonStockDividendsShares,
                                    StockDividendsShares,
                                    StockIssuedDuringPeriodValueDividendReinvestmentPlan,
                                    StockIssuedDuringPeriodSharesDividendReinvestmentPlan,
                                    StockIssuedDuringPeriodValuePurchaseOfAssets,
                                    StockIssuedDuringPeriodSharesPurchaseOfAssets,
                                    StockIssuedDuringPeriodValueOther,
                                    StockIssuedDuringPeriodSharesOther,
                                    StockIssuedDuringPeriodSharesStockSplits,
                                    StockIssuedDuringPeriodSharesReverseStockSplits, /** Assume use calc to negate **/
                                    StockRepurchasedAndRetiredDuringPeriodValue,
                                    StockRepurchasedAndRetiredDuringPeriodShares,
                                    StockRepurchasedDuringPeriodValue,
                                    StockRepurchasedDuringPeriodShares,
                                    StockRedeemedOrCalledDuringPeriodValue,
                                    StockRedeemedOrCalledDuringPeriodShares,
                                    TreasuryStockRetiredParValueMethodAmount,
                                    TreasuryStockRetiredCostMethodAmount,
                                    TreasuryStockSharesRetired,
                                    AmortizationOfESOPAward
                                    )

$fact1 =
	{nonils @concept in $Common_Stock_Positive @StatementEquityComponentsAxis=CommonStockMember @unit=* where $fact < 0 and ($fact.dimensions.length == 1 or 
		(not match_set_substring($fact, $EXCLUDE_NON_NEG_STRING_MEMBERS)
		and (to-set($fact.dimensions-explicit.values.name) intersect $EXCLUDE_NON_NEG_MEMBERS).length == 0
		and ($fact.dimensions.keys.name intersect (($EXCLUDE_NON_NEG_AXIS + set(StatementClassOfStockAxis)) - set(StatementEquityComponentsAxis))).length == 0
		and not_elim_adjust($fact, $EXCLUDE_NON_NEG_AXIS_MEMBERS)))
		};  /** Included class of stock axis for transfers between classes of stock which can make a value negative**/
true

message
"{$fact1.concept} has a value of {$fact1} which is less than zero. This element should not have a negative value when used with the common stock [Member]. The preparer should consider if the value is input correctly for this assertion and, after considering the appropriateness of the input, if incorrect, input the amount as a positive (i.e., absolute) value and provide a negated label.

The properties of this {$fact1.concept} fact are:
Period :{$fact1.period}
Dimensions : {$fact1.dimensions.join(', ','=')}
Unit : {$fact1.unit}
Rule Element Id:{$rule_id}
Rule version: {$ruleVersion}"


severity error

effectiveDate $effective_dates[$rule_id]


constant $APIC_ADJUSTMENTS = navigate parent-child descendants from AdjustmentsToAdditionalPaidInCapitalAbstract taxonomy $US-GAAP where $relationship.target.is-monetary == true returns set (target-name)

constant $ELEMENT_COMMON_STOCK_EMPTY = set(PreferredStockSharesOutstanding, 
                                    AdjustmentsToAdditionalPaidInCapitalEquityComponentOfConvertibleDebt,           
                                    AdjustmentsToAdditionalPaidInCapitalEquityComponentOfConvertibleDebtSubsequentAdjustments,
                                    PreferredStockDividendsShares,
                                    StockIssuedDuringPeriodValueTreasuryStockReissued,
                                    TreasuryStockPreferredValue,
                                    ProfitLoss,
                                    NetIncomeLossAttributableToRedeemableNoncontrollingInterest,
                                    NetIncomeLossIncludingPortionAttributableToNonredeemableNoncontrollingInterest,
                                    OtherComprehensiveIncomeLossNetOfTax,
                                    PreferredStockRedemptionPremium,
                                    PreferredStockRedemptionDiscount,
                                    PreferredStockAccretionOfRedemptionDiscount,
                                    IncreaseInCarryingAmountOfRedeemablePreferredStock,
                                    PreferredStockConvertibleDownRoundFeatureIncreaseDecreaseInEquityAmount1,
                                    NoncontrollingInterestIncreaseFromSubsidiaryEquityIssuance,
                                    NoncontrollingInterestIncreaseFromSaleOfParentEquityInterest,
                                    NoncontrollingInterestIncreaseFromBusinessCombination,
                                    ComprehensiveIncomeNetOfTaxAttributableToNoncontrollingInterest,
                                    MinorityInterestDecreaseFromDistributionsToNoncontrollingInterestHolders,
                                    MinorityInterestDecreaseFromRedemptions,
                                    NoncontrollingInterestDecreaseFromDeconsolidation
                                    ) + ($APIC_ADJUSTMENTS - set(AdjustmentsToAdditionalPaidInCapitalStockIssuedIssuanceCosts))

constant $TREASURY_STOCK_MONETARY_ELEMENTS = set(TreasuryStockCommonValue,
                                    TreasuryStockPreferredValue,
                                    TreasuryStockValue,
                                    TreasuryStockValueAcquiredParValueMethod,
                                    TreasuryStockValueAcquiredCostMethod,
                                    TreasuryStockReissuedAtLowerThanRepurchasePrice,
                                    TreasuryStockCarryingBasis
                                    )

ASSERT US.0194.10622 satisfied

$rule_id = (rule-name().split('.'))[rule-name().split('.').length];

$fact1 = {nonils @concept in $ELEMENT_COMMON_STOCK_EMPTY @StatementEquityComponentsAxis = CommonStockMember @unit=* where $fact != 0}

true

message
"{$fact1.concept} has a value of {$fact1} and has been used with the common stock Member. This element should not have a value when used with the common stock [Member]. The preparer should consider if the value is input correctly or if a different element or member should be used.

The properties of this {$fact1.concept} fact are:
Period :{$fact1.period}
Dimensions : {$fact1.dimensions.join(', ','=')}
Unit : {$fact1.unit}
Rule Element Id:{$rule_id}
Rule version: {$ruleVersion}"


severity error

effectiveDate $effective_dates[$rule_id]


/** Check STockholders Equity for the correct opening balance element.**/

ASSERT US.0194.10623 satisfied

$rule_id = (rule-name().split('.'))[rule-name().split('.').length];

$NCI = (navigate parent-child descendants include start from list(NoncontrollingInterestMember, AociIncludingPortionAttributableToNoncontrollingInterestMember) taxonomy $US-GAAP returns set (target-name));

$fact1 = {@concept = StockholdersEquity @StatementEquityComponentsAxis in $NCI  @unit=*}

exists($fact1)

message
"{$fact1.concept} has a value of {$fact1} and has been used with an Non Controlling Interest member on the StatementEquityComponentsAxis. This element should not have a value when used with the with this [Member] as {$fact1.concept} does not include non controlling interest. Change the element {$fact1.concept} to StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest.

The properties of this {$fact1.concept} fact are:
Period :{$fact1.period}
Dimensions : {$fact1.dimensions.join(', ','=')}
Unit : {$fact1.unit}
Rule Element Id:{$rule_id}
Rule version: {$ruleVersion}"


severity error

effectiveDate $effective_dates[$rule_id]


ASSERT US.0194.10624 satisfied

$rule_id = (rule-name().split('.'))[rule-name().split('.').length];

$treasury =  set(TreasuryStockCommonMember, TreasuryStockPreferredMember);

$fact1 = {@concept in list(SharesOutstanding,CommonStockSharesOutstanding, PreferredStockSharesOutstanding, SharesIssued, CommonStockSharesIssued, PreferredStockSharesIssued ) @StatementEquityComponentsAxis in $treasury  @unit=*}

exists($fact1)

message
"{$fact1.concept} has a value of {$fact1} and has been used with Treasury Stock Member on the StatementEquityComponentsAxis. This element should not have a value when used with Treasury Stock Member.  FASB FAQ guidance (https://xbrl.fasb.org/resources/taxonomyfaq.pdf) 2.16 requires that specifc line item elements are used for treasury shares such as TreasuryStockCommonShares and TreasuryStockPreferredShares rather than {$fact1.concept.name}.

The properties of this {$fact1.concept} fact are:
Period :{$fact1.period}
Dimensions : {$fact1.dimensions.join(', ','=')}
Unit : {$fact1.unit}
Rule Element Id:{$rule_id}
Rule version: {$ruleVersion}"


severity error

effectiveDate $effective_dates[$rule_id]


constant $TREASURY_STOCK_SHARE_ELEMENTS = list(TreasuryStockSharesAcquired,
                                    StockIssuedDuringPeriodSharesTreasuryStockReissued,
                                    TreasuryStockSharesRetired,
                                    StockRepurchasedDuringPeriodShares
                                    )


/** THis can be super confusingin terms of multiple meanings.  WHats the difference between treasuryStockSharesAqcuired and StockRepurchasedDuringPeriodShares and the treasury stock member

The issue is further complicated by the fact that common stock for shares can be either outstanding or issued where as the value amount for common stock is not netted for tresury. 

In the notes if you see treasuryStockSharesAqcuired with common stock member then this implies the shares colum is outstanding in the SHE. 

It seems to me none of the treasury share elements should be used if the changes in she uses the shares outstanding rather than the shares issued

An example of this is here : https://www.sec.gov/ix?doc=/Archives/edgar/data/846475/000155837024010200/zyxi-20240630x10q.htm

This filing has treasury but for the shares colum uses shares outstanding and not issued.  In the notes they disclose share buybacks going into treasury.  SHouldnt the elemnts be consistent with the statement of SHE.**/

constant  $COMMON_STOCK_SHARES_ISSUED_METHOD = if exists([covered @concept = SharesIssued  @StatementEquityComponentsAxis = CommonStockMember  @period=*])
                                                    true
                                                else
                                                    false

/** IF TREASURURY IS ZERO SHOULD RULE FLAG **/
ASSERT US.0194.10625 satisfied

$rule_id = (rule-name().split('.'))[rule-name().split('.').length];



if  $COMMON_STOCK_SHARES_ISSUED_METHOD

    $treasury =  set(TreasuryStockSharesAcquired,
                StockIssuedDuringPeriodSharesTreasuryStockReissued,
                StockRepurchasedDuringPeriodShares
                )

    $fact1 = {@concept in $treasury  @StatementEquityComponentsAxis = CommonStockMember  @unit=*}

    exists($fact1)

else

    $treasury2 =  set(TreasuryStockSharesRetired)

    $fact1 = {@concept in $treasury2  @StatementEquityComponentsAxis = CommonStockMember  @unit=*}

    exists($fact1)


message
"{$fact1.concept} has a value of {$fact1} and has been used with the common stock member on the StatementEquityComponentsAxis. This element should not have a value when used with the with this Member as {$fact1.concept} should not impact common stock. Change the opening balance share element {$fact1.concept} to {if $fact1.concept.name.local-name == 'TreasuryStockSharesRetired' 'SharesIssued' else 'SharesOutstanding'}.

The properties of this {$fact1.concept} fact are:
Period :{$fact1.period}
Dimensions : {$fact1.dimensions.join(', ','=')}
Unit : {$fact1.unit}
Rule Element Id:{$rule_id}
Rule version: {$ruleVersion}"


severity error

effectiveDate $effective_dates[$rule_id]


/** Add rule to check cannot have stock issued and  stock outstanding with the common stock member **/

ASSERT US.0194.10626 satisfied

$rule_id = (rule-name().split('.'))[rule-name().split('.').length];

$fact1 = {@concept = SharesIssued  @StatementEquityComponentsAxis = CommonStockMember  @period=*}

$fact2 = {@concept = SharesOutstanding  @StatementEquityComponentsAxis = CommonStockMember  @period=*}

exists($fact1) and exists($fact2)

message
"The filer has used the concept {$fact1.concept} with a value of {$fact1} and has also used the value {$fact2.concept} with a value of {$fact2} both using the common stock member. The filer should report one or the other but not both when using the common stock member. If the column representing shares in the Changes in equity represents issued shares then the SharesOutstanding elememnt should not be used with the common stock member. If the column representing shares in the Changes in equity represents outstanding shares then the SharesIssued element should not be used with the common stock member.

The properties of this {$fact1.concept} fact are:
Period :{$fact1.period}
Dimensions : {$fact1.dimensions.join(', ','=')}
Unit : {$fact1.unit}
Rule Element Id:{$rule_id}
Rule version: {$ruleVersion}"


severity error

effectiveDate $effective_dates[$rule_id]



ASSERT US.0194.10627 satisfied

$rule_id = (rule-name().split('.'))[rule-name().split('.').length];

/** LOok at allowable values for common stock **/

$Element_Retained_Earnings_empty = set(SharesOutstanding, 
                                    CommonStockSharesOutstanding, 
                                    StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest,
                                    StockIssuedDuringPeriodValueNewIssues,
                                    StockIssuedDuringPeriodSharesNewIssues,
                                    StockIssuedDuringPeriodValueIssuedForServices,
                                    StockIssuedDuringPeriodSharesIssuedForServices,
                                    StockGrantedDuringPeriodValueSharebasedCompensationGross,
                                    StockGrantedDuringPeriodValueSharebasedCompensationForfeited,
                                    StockGrantedDuringPeriodValueSharebasedCompensation,
                                    ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsGrantsInPeriodGross,
                                    ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsForfeituresInPeriod,
                                    ShareBasedCompensationArrangementByShareBasedPaymentAwardOptionsGrantsInPeriod,
                                    StockIssuedDuringPeriodValueShareBasedCompensationGross,
                                    StockIssuedDuringPeriodValueShareBasedCompensationForfeited,
                                    StockIssuedDuringPeriodValueShareBasedCompensation,
                                    StockIssuedDuringPeriodSharesShareBasedCompensationGross,
                                    StockIssuedDuringPeriodSharesShareBasedCompensationForfeited,
                                    StockIssuedDuringPeriodSharesShareBasedCompensation,
                                    StockIssuedDuringPeriodValueRestrictedStockAwardGross,
                                    StockIssuedDuringPeriodValueRestrictedStockAwardForfeitures,
                                    StockIssuedDuringPeriodValueRestrictedStockAwardNetOfForfeitures,
                                    StockIssuedDuringPeriodSharesRestrictedStockAwardGross,
                                    StockIssuedDuringPeriodSharesRestrictedStockAwardForfeited,
                                    StockIssuedDuringPeriodSharesRestrictedStockAwardNetOfForfeitures,
                                    StockIssuedDuringPeriodValueStockOptionsExercised,
                                    StockIssuedDuringPeriodSharesStockOptionsExercised,
                                    StockIssuedDuringPeriodValueEmployeeStockOwnershipPlan,
                                    StockIssuedDuringPeriodSharesEmployeeStockOwnershipPlan,
                                    StockIssuedDuringPeriodValueEmployeeStockPurchasePlan,
                                    StockIssuedDuringPeriodSharesEmployeeStockPurchasePlans,
                                    StockIssuedDuringPeriodValueEmployeeBenefitPlan,
                                    StockIssuedDuringPeriodSharesEmployeeBenefitPlan,
                                    StockIssuedDuringPeriodValueAcquisitions,
                                    StockIssuedDuringPeriodSharesAcquisitions,
                                    StockIssuedDuringPeriodValueConversionOfConvertibleSecurities,
                                    StockIssuedDuringPeriodSharesConversionOfConvertibleSecurities,
                                    StockIssuedDuringPeriodValueConversionOfConvertibleSecuritiesNetOfAdjustments,
                                    StockIssuedDuringPeriodValueConversionOfUnits,
                                    StockIssuedDuringPeriodSharesConversionOfUnits,
                                    StockIssuedDuringPeriodValueStockDividend,
                                    CommonStockDividendsShares,
                                    StockDividendsShares,
                                    StockIssuedDuringPeriodValueDividendReinvestmentPlan,
                                    StockIssuedDuringPeriodSharesDividendReinvestmentPlan,
                                    StockIssuedDuringPeriodValuePurchaseOfAssets,
                                    StockIssuedDuringPeriodSharesPurchaseOfAssets,
                                    StockIssuedDuringPeriodValueOther,
                                    StockIssuedDuringPeriodSharesOther,
                                    StockIssuedDuringPeriodSharesStockSplits,
                                    StockIssuedDuringPeriodSharesReverseStockSplits, /** Assume use calc to negate **/
                                    StockRepurchasedAndRetiredDuringPeriodValue,
                                    StockRepurchasedAndRetiredDuringPeriodShares,
                                    StockRepurchasedDuringPeriodValue,
                                    StockRepurchasedDuringPeriodShares,
                                    StockRedeemedOrCalledDuringPeriodValue,
                                    StockRedeemedOrCalledDuringPeriodShares,
                                    TreasuryStockRetiredParValueMethodAmount,
                                    TreasuryStockRetiredCostMethodAmount,
                                    TreasuryStockSharesRetired,
                                    AmortizationOfESOPAward,
                                    PreferredStockSharesOutstanding, 
                                    AdjustmentsToAdditionalPaidInCapitalEquityComponentOfConvertibleDebt,           
                                    AdjustmentsToAdditionalPaidInCapitalEquityComponentOfConvertibleDebtSubsequentAdjustments,
                                    PreferredStockDividendsShares,
                                    StockIssuedDuringPeriodValueTreasuryStockReissued,
                                    TreasuryStockPreferredValue,
                                    PreferredStockRedemptionPremium,
                                    PreferredStockRedemptionDiscount,
                                    PreferredStockAccretionOfRedemptionDiscount,
                                    IncreaseInCarryingAmountOfRedeemablePreferredStock,
                                    PreferredStockConvertibleDownRoundFeatureIncreaseDecreaseInEquityAmount1,
                                    NoncontrollingInterestIncreaseFromSubsidiaryEquityIssuance,
                                    NoncontrollingInterestIncreaseFromSaleOfParentEquityInterest,
                                    NoncontrollingInterestIncreaseFromBusinessCombination,
                                    ComprehensiveIncomeNetOfTaxAttributableToNoncontrollingInterest,
                                    MinorityInterestDecreaseFromDistributionsToNoncontrollingInterestHolders,
                                    MinorityInterestDecreaseFromRedemptions,
                                    NoncontrollingInterestDecreaseFromDeconsolidation,
                                    TreasuryStockCommonValue,
                                    TreasuryStockPreferredValue,
                                    TreasuryStockValue,
                                    TreasuryStockValueAcquiredParValueMethod,
                                    TreasuryStockValueAcquiredCostMethod,
                                    TreasuryStockReissuedAtLowerThanRepurchasePrice,
                                    TreasuryStockCarryingBasis
                                    )

$fact1 = {nonils @concept in $Element_Retained_Earnings_empty @StatementEquityComponentsAxis in list(RetainedEarningsMember, RetainedEarningsAppropriatedMember, RetainedEarningsUnappropriatedMember) @unit=* where $fact != 0}

true

message
"{$fact1.concept} has a value of {$fact1} and has been used with a retained earnings member. This element should not have a value when used with a retained earnings member. The preparer should consider if the value is input correctly or if a different element or member should be used.

The properties of this {$fact1.concept} fact are:
Period :{$fact1.period}
Dimensions : {$fact1.dimensions.join(', ','=')}
Unit : {$fact1.unit}
Rule Element Id:{$rule_id}
Rule version: {$ruleVersion}"

                                      