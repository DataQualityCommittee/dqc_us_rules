/**
DQC Rules
 (c) Copyright 2017 - 2023, XBRL US Inc. All rights reserved.
 See https://xbrl.us/dqc-license for license information.
 See https://xbrl.us/dqc-patent for patent infringement notice.
Taxonomy: US GAAP 2022
**/

rule-name-prefix DQC

/** Ensure that tax reconciliation is updated for FDII elements added to the taxonomy.
**/
constant $FDII_EXTENSION_ITEMS = list('BenefitForForeignDerivedIntangibleIncome',
'BenefitOfForeignDerivedIntangibleIncome',
'ChangeInEffectiveIncomeTaxRateReconciliationGILTIAndFDIIPercent',
'DeductionAvailableFromForeignDerivedIntangibleIncome',
'DeductionforForeignDerivedIntangibleIncome',
'DeductionForForeignDerivedIntangibleIncome',
'EffectiveIncomeRateReconciliationForeignDerivedIntangibleIncomeDeduction',
'EffectiveIncomeRateReconciliationForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconcilationForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationAmountFDII',
'EffectiveIncomeTaxRateReconciliationAntitrustSettlementFDIIDeducation',
'EffectiveIncomeTaxRateReconciliationAntitrustSettlementFDIIDeduction',
'EffectiveIncomeTaxRateReconciliationAtForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationChangeInForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationChangesDueToGILTIFDIIAndBEAT',
'EffectiveIncomeTaxRateReconciliationChangesDueToGILTIFDIIAndBEATPercent',
'EffectiveIncomeTaxRateReconciliationDeductionFdiiAmount',
'EffectiveIncomeTaxRateReconciliationDeductionForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationDeductionForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationDeductionForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationDeductionForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationDeductionForeignDerivedIntangibleIncomePriorAndCurrentYears',
'EffectiveIncomeTaxRateReconciliationDeductionForForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationDeductionsForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationDeductionsForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationDeductionsForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationDeductionTaxCutsAndJobsActForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationDeductionTCJAFDIIPercent',
'EffectiveIncomeTaxRateReconciliationEffectOfFDII',
'EffectiveincometaxratereconciliationFDIIAmount',
'EffectiveIncomeTaxRateReconciliationFDIIAmount',
'EffectiveIncomeTaxRateReconciliationFdiiDeduction',
'EffectiveIncomeTaxRateReconciliationFDIIDeduction',
'EffectiveIncomeTaxRateReconciliationFDIIDeductionAmount',
'EffectiveIncomeTaxRateReconciliationFDIIDeductionPercent',
'EffectiveIncomeTaxRateReconciliationFDIIPercent',
'EffectiveIncomeTaxRateReconciliationFdiiProvisionPercent',
'EffectiveIncomeTaxRateReconciliationFDIITaxBenefit',
'Effectiveincometaxratereconciliationforeignderivedintangibleincome',
'EffectiveIncometaxRateReconciliationForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationForeignderivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncome',
'Effectiveincometaxratereconciliationforeignderivedintangibleincomeamount',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeBenefit',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeBenefitAmount',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeBenefitPercent',
'EffectiveIncomeTaxRateReconciliationforeignderivedintangibleincomededuction',
'EffectiveIncomeTaxRateReconciliationForeignderivedintangibleincomededuction',
'EffectiveIncomeTaxRateReconciliationForeignderivedIntangibleIncomeDeduction',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeduction',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeductionAmount',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeductionasaPercent',
'EffectiveIncomeTaxRateReconciliationForeignderivedIntangibleIncomeDeductionBasedOnUpdatedTreasuryRegulationsAmount',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeductionFDII',
'EffectiveIncomeTaxRateReconciliationForeignderivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationForeignderivedIntangibleIncomeDeductionPercentage',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeductions',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeductionsFDIIPercent',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeFDIIDeductionAmount',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeNetOfGlobalIntangibleLowTaxedIncome',
'EffectiveIncometaxRateReconciliationForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomePercentage',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeTaxesPercent',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeTaxExpenseBenefit',
'EffectiveIncomeTaxRateReconciliationGILTIAndFDIIAmount',
'EffectiveIncomeTaxRateReconciliationGILTIAndFDIIPercent',
'EffectiveIncomeTaxRateReconciliationGILTIAndForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationGILTIFDIIAmount',
'EffectiveIncomeTaxRateReconciliationGILTIFDIIPercent',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeAndFDIIAmount',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeAndFDIIPercent',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeAndForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeForeignDerivedIntangibleIncomeDeductionAmount',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeLossOnForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeOrForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxIncomeAndForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxIncomeAndForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationImpactFromForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationImpactofGILTIandFDII',
'EffectiveIncomeTaxRateReconciliationNetBenefitFromGlobalIntangibleLowTaxedIncomeAndForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationNetEffectOfGILTIFDIIBEAT',
'EffectiveIncomeTaxRateReconciliationOfUsIncentiveForForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationPercentFDII',
'EffectiveIncomeTaxRateReconciliationTaxBenefitForForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationTaxCutAndJobsActOf2017ForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActDeductionForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationTaxCutsandJobsActGILTIFDIIAndBEATProvisionsPercent',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActGILTIFDIIAndBEATProvisionsPercent',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActof2017ForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationTaxForeignDerivedIntangibleIncomeDeduction',
'EffectiveIncomeTaxReconciliationFDIIDeduction',
'EffectiveIncometaxReconciliationForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxReconciliationForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxReconciliationForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxReconciliationForeignDerivedIntangibleIncomeDeduction',
'EffectiveIncomeTaxReconciliationForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxReconciliationForeignDerivedIntangibleIncomeTaxAmount',
'EffectiveIncomeTaxReconciliationForeignDerivedIntangibleIncomeTaxRate',
'EffectiveIncomeTaxReconciliationTaxBenefitRelatedToForeignDerivedIntangibleIncomeDeduction',
'EffectiveratereconciliationFDII',
'EffectiveTaxRateReconciliationChangeForFDIIProvision',
'EffectiveTaxRateReconciliationForeignDerivedIntangibleIncomeDeduction',
'EffectiveTaxRateReconciliationForeignderivedintangibleincomedeductionPercent',
'EffectiveTaxRateReconciliationIncreaseinForeignDerivedIntangibleIncome',
'EstimatedAnnualizedTaxDeductionForFDII',
'EstimatedForeignderivedIntangibleIncomeDeduction',
'EstimatedIncrementalUnitedStatesTaxSavingsOnForeignDerivedIntangibleIncome',
'EstimatedTaxBenefitAssociatedWithForeignDerivedIntangibleIncome',
'FDIIDeductionForTaxReform',
'FDIIIncomeTaxExpenseBenefit',
'FederalStatutoryIncomeTaxRateDeductionOnForeignDerivedIntangibleIncome',
'Foreignderivedintangibleincome',
'Foreignderivedintangibleincomededuction',
'ForeignderivedIntangibleIncomeDeduction',
'ForeignDerivedIntangibleIncomeDeduction',
'ForeignDerivedIntangibleIncomeDeductionAmount',
'ForeignderivedIntangibleIncomeDeductionIncomeTaxExpenseBenefit',
'ForeignDerivedIntangibleIncomeDeductionIncomeTaxExpenseBenefit',
'ForeignDerivedIntangibleIncomeDeductionLimitPercent',
'ForeignderivedIntangibleIncomeDeductionPercent',
'ForeignDerivedIntangibleIncomeFdii',
'ForeignDerivedIntangibleIncomeFDII',
'ForeignDerivedIntangibleIncomeFDIIEffectiveTaxRate',
'ForeignDerivedIntangibleIncomeImpactDeductionOfIncomeTaxExpense',
'ForeignDerivedIntangibleIncomeTaxCredit',
'ForeignDerivedIntangibleIncomeTaxDeduction',
'ForeignDerivedIntangibleIncomeTaxExpenseBenefit',
'IncomeTaxBenefitRelatedToInitialApplicationToForeignDerivedIntangibleIncome',
'IncomeTaxExpenseBenefitContinuingOperationsForeignDerivedIntangibleIncome',
'IncomeTaxExpenseBenefitForeignDerivedIntangibleIncome',
'IncomeTaxExpenseBenefitFromForeignDerivedIntangibleIncomeProvisions',
'IncomeTaxRateReconciliationDeductionForeignDerivedIntangibleIncome',
'IncomeTaxRateReconciliationGILTIFDIIAndBEATAmount',
'IncomeTaxReconciliationChangeInForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationDeduction_FDII',
'IncomeTaxReconciliationDeductionForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationDeductionsFDII',
'IncomeTaxReconciliationDeductionsFDIIPercent',
'IncomeTaxReconciliationDeductionsForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationFDIIDeduction',
'IncomeTaxReconciliationFDIIGILTIAndOtherProvisions',
'Incometaxreconciliationforeignderivedintangibleincome',
'IncomeTaxReconciliationForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationForeignDerivedIntangibleIncomeBenefit',
'IncomeTaxReconciliationForeignDerivedIntangibleIncomeDeduction',
'IncomeTaxReconciliationForeignDerivedIntangibleIncomeDeductionAmount',
'IncomeTaxReconciliationForeignDerivedIntangibleIncomeFDIIAmount',
'IncomeTaxReconciliationGiltiFdii',
'IncomeTaxReconciliationGlobalIntangibleLowTaxIncomeAndForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationIncomeTaxExpenseBenefitAtForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationNetEffectGiltiAndFdii',
'IncomeTaxReconciliationNondeductibleBenefitForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationNondeductibleExpenseBenefitForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationSection250ForeignDerivedIntangibleIncomeDeduction',
'IncrementalPercentagePointsRelatedToForeignDerivedIntangibleIncomeFDIIAndCapitalizationOfRDBenefit',
'NetTaxBenefitFromForeignDerivedIntangibleIncome',
'PercentageOfDecreaseInTaxCutsAndJobsActOf2017IncompleteAccountingForeignDerivedIntangibleIncome',
'PercentageOfForeignDerivedIntangibleIncomeDeduction',
'PercentageOfForeignDerivedIntangibleIncomeRelatedToFavorableImpactOnPriorYearsFromFinalRegulations',
'ReductionInIncomeTaxExpenseForFDII',
'TaxBenefitFromOurForeignDerivedIntangibleIncome',
'TaxCutsandJobsActAccountingCompleteIncomeTaxExpenseBenefitForeignDerivedIntangibleIncome',
'TaxCutsandJobsActForeignDerivedIntangibleIncomeDeductionBenefit',
'TaxCutsAndJobsActForeignDerivedIntangibleIncomeIncomeTaxExpenseBenefit',
'TaxCutsAndJobsActGlobalIntangibleLowTaxedIncomeAndForeignDerivedIntangibleIncomeIncomeTaxExpenseBenefit',
'TaxCutsAndJobsActIncomeTaxExpenseBenefitForeignDerivedIntangibleIncome',
'TaxCutsandJobsActIncompleteAccountingForeignDerivedIntangibleIncomeProvisionalIncomeTaxExpenseBenefit',
'TaxCutsAndJobsActOf2017ChangeInTaxRateIncomeTaxBenefitOnForeignDerivedIntangibleIncome',
'TaxCutsAndJobsActOf2017DeferredTaxAssetsUndistributedForeignEarningsForeignDerivedIntangibleIncomeFDII',
'TaxCutsAndJobsActOf2017DeferredTaxAssetsUndistributedForeignEarningsGlobalIntangibleLowTaxedIncomeAndForeignDerivedIntangibleIncomeGILTIFDII',
'TaxCutsAndJobsActOf2017DeferredTaxLiabilitiesUndistributedForeignEarningsGlobalIntangibleLowTaxedIncomeGILTIFDIIAndBEAT',
'TaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeDeduction',
'TaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeDeductionBenefit',
'TaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeDeductionIncomeTaxBenefitExpense',
'TaxCutsAndJobsActof2017ForeignDerivedIntangibleIncomeExpenseBenefit',
'TaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeIncomeTaxExpenseBenefit',
'TaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeProvisionalTax',
'TaxCutsandJobsActof2017GILTIandFDII',
'TaxCutsAndJobsActOf2017GILTIProvisionalIncomeTaxExpenseNetOfFDII',
'TaxCutsAndJobsActOf2017IncompleteAccountingDecreaseInEffectiveTaxRateAsResultOfForeignDerivedIntangibleIncomeProvision',
'TaxCutsAndJobsActOf2017IncompleteAccountingDecreaseInEffectiveTaxRateFromContinuingOperationsAsResultOfForeignDerivedIntangibleIncomeProvision',
'TaxCutsAndJobsActOf2017IncompleteAccountingDecreaseInEffectiveTaxRateFromDiscontinuedOperationsAsResultOfForeignDerivedIntangibleIncomeProvision',
'TaxCutsAndJobsActOf2017IncompleteAccountingGILTIProvisionalIncomeTaxExpenseNetOfFDII',
'TaxEffectOfUnitedStatesForeignDerivedIntangibleIncomeDeduction',
'TaxonforeignearningsU.S.TaxLegislationGILTIandFDII',
'TaxonforeignearningsU.S.taxreformGILTIandFDII',
'U.S.deductionforforeignderivedintangibleincome',
'UsGaap_EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncome',
'U.S.taxreformimpactGILTIandFDII',
'EffectiveIncomeTaxRateReconciliationBenefitOfForeignIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationDeductionForeignIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationDeductionForeignIntangibleIncomeDeductionAmount',
'EffectiveIncomeTaxRateReconciliationDeductionForeignIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationForeignIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationForeignIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationForeignIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationForeignIntangibleIncomePercent',
'TaxCutsAndJobsActIncomeTaxExpenseBenefitForeignIntangibleIncome')

constant $FDII_MEMBERS = list('FDIIEffectiveTaxRateMember')

assert US.0154.9881  satisfied
$ruleId = (rule-name().split('.'))[rule-name().split('.').length];

/**Find cases where an extension is used **/
$fdii_reported_amount = list([covered @concept.local-name in $FDII_EXTENSION_ITEMS])

$fdii_extension_concepts = ($fdii_reported_amount.concept.name).to-set;

$fdii_reported_amount.length > 0

message
"The filer has reported a value for foreign-derived intangible income that is not using the element defined in the US-GAAP taxonomy.  The FASB has added elements for the FDII percntage amount and the FDII monetary amount in the 2022 taxonomy.  These elements are:

1. EffectiveIncomeTaxRateReconciliationFdiiPercent
2. EffectiveIncomeTaxRateReconciliationFdiiAmount

The extension  element(s) {$fdii_extension_concepts.join(", ")}  has been used in the filing that should be updated to the appropriate  US-GAAP element listed above.

Rule Element Id:{$ruleId}
Rule version: {$ruleVersion}
"

assert US.0154.9882  satisfied

$ruleId = (rule-name().split('.'))[rule-name().split('.').length];
/** Look where base elements are used incorrectly look at the qcom qualcomm filing for 2022 10-K**/

$standard_deduction_elements = list(EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActOf2017Amount, EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActOf2017Percent, IncomeTaxReconciliationTaxCreditsForeign, EffectiveIncomeTaxRateReconciliationTaxCreditsForeign, qname($EXTENSION_NS,'EffectiveIncomeTaxRateReconciliationGILTIPercent'));


for $x in $standard_deduction_elements
    $label = taxonomy().concept($x).label.text
    if $label.lower-case.contains('fdii') or $label.lower-case.contains('foreign-derived intangible income') or $label.lower-case.contains('foreign derived intangible income')
        true
    else
        skip

message
"The filer has reported a value for foreign-derived intangible income that is not using the element defined in the US-GAAP taxonomy.  The FASB has added elements for the FDII percntage amount and the FDII monetary amount in the 2022 taxonomy.  These elements are:

1. EffectiveIncomeTaxRateReconciliationFdiiAmount
2. EffectiveIncomeTaxRateReconciliationFdiiPercent

The filing has used the element {$x} in the filing with a label of {$label}.  The element should be changed to one of the elements defined above.

Rule Element Id:{$ruleId}
Rule version: {$ruleVersion}
"