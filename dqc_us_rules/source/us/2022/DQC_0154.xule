/**
DQC Rules
 (c) Copyright 2017 - 2023, XBRL US Inc. All rights reserved.
 See https://xbrl.us/dqc-license for license information.
 See https://xbrl.us/dqc-patent for patent infringement notice.
Taxonomy: US GAAP 2022
**/

rule-name-prefix DQC

/** Ensure that tax reconciliation is updated for FDII elements added to the taxonomy.
**/
constant $FDII_EXTENSION_ITEMS = list('BenefitForForeignDerivedIntangibleIncome',
'BenefitOfForeignDerivedIntangibleIncome',
'ChangeInEffectiveIncomeTaxRateReconciliationGILTIAndFDIIPercent',
'DeductionAvailableFromForeignDerivedIntangibleIncome',
'DeductionforForeignDerivedIntangibleIncome',
'DeductionForForeignDerivedIntangibleIncome',
'EffectiveIncomeRateReconciliationForeignDerivedIntangibleIncomeDeduction',
'EffectiveIncomeRateReconciliationForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconcilationForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationAmountFDII',
'EffectiveIncomeTaxRateReconciliationAntitrustSettlementFDIIDeducation',
'EffectiveIncomeTaxRateReconciliationAntitrustSettlementFDIIDeduction',
'EffectiveIncomeTaxRateReconciliationAtForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationChangeInForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationChangesDueToGILTIFDIIAndBEAT',
'EffectiveIncomeTaxRateReconciliationChangesDueToGILTIFDIIAndBEATPercent',
'EffectiveIncomeTaxRateReconciliationDeductionFdiiAmount',
'EffectiveIncomeTaxRateReconciliationDeductionForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationDeductionForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationDeductionForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationDeductionForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationDeductionForeignDerivedIntangibleIncomePriorAndCurrentYears',
'EffectiveIncomeTaxRateReconciliationDeductionForForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationDeductionsForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationDeductionsForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationDeductionsForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationDeductionTaxCutsAndJobsActForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationDeductionTCJAFDIIPercent',
'EffectiveIncomeTaxRateReconciliationEffectOfFDII',
'EffectiveincometaxratereconciliationFDIIAmount',
'EffectiveIncomeTaxRateReconciliationFDIIAmount',
'EffectiveIncomeTaxRateReconciliationFdiiDeduction',
'EffectiveIncomeTaxRateReconciliationFDIIDeduction',
'EffectiveIncomeTaxRateReconciliationFDIIDeductionAmount',
'EffectiveIncomeTaxRateReconciliationFDIIDeductionPercent',
'EffectiveIncomeTaxRateReconciliationFDIIPercent',
'EffectiveIncomeTaxRateReconciliationFdiiProvisionPercent',
'EffectiveIncomeTaxRateReconciliationFDIITaxBenefit',
'Effectiveincometaxratereconciliationforeignderivedintangibleincome',
'EffectiveIncometaxRateReconciliationForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationForeignderivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncome',
'Effectiveincometaxratereconciliationforeignderivedintangibleincomeamount',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeBenefit',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeBenefitAmount',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeBenefitPercent',
'EffectiveIncomeTaxRateReconciliationforeignderivedintangibleincomededuction',
'EffectiveIncomeTaxRateReconciliationForeignderivedintangibleincomededuction',
'EffectiveIncomeTaxRateReconciliationForeignderivedIntangibleIncomeDeduction',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeduction',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeductionAmount',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeductionasaPercent',
'EffectiveIncomeTaxRateReconciliationForeignderivedIntangibleIncomeDeductionBasedOnUpdatedTreasuryRegulationsAmount',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeductionFDII',
'EffectiveIncomeTaxRateReconciliationForeignderivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationForeignderivedIntangibleIncomeDeductionPercentage',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeductions',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeDeductionsFDIIPercent',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeFDIIDeductionAmount',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeNetOfGlobalIntangibleLowTaxedIncome',
'EffectiveIncometaxRateReconciliationForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomePercentage',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeTaxesPercent',
'EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncomeTaxExpenseBenefit',
'EffectiveIncomeTaxRateReconciliationGILTIAndFDIIAmount',
'EffectiveIncomeTaxRateReconciliationGILTIAndFDIIPercent',
'EffectiveIncomeTaxRateReconciliationGILTIAndForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationGILTIFDIIAmount',
'EffectiveIncomeTaxRateReconciliationGILTIFDIIPercent',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeAndFDIIAmount',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeAndFDIIPercent',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeAndForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeForeignDerivedIntangibleIncomeDeductionAmount',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeLossOnForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxedIncomeOrForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxIncomeAndForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationGlobalIntangibleLowTaxIncomeAndForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationImpactFromForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationImpactofGILTIandFDII',
'EffectiveIncomeTaxRateReconciliationNetBenefitFromGlobalIntangibleLowTaxedIncomeAndForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationNetEffectOfGILTIFDIIBEAT',
'EffectiveIncomeTaxRateReconciliationOfUsIncentiveForForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationPercentFDII',
'EffectiveIncomeTaxRateReconciliationTaxBenefitForForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationTaxCutAndJobsActOf2017ForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActDeductionForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationTaxCutsandJobsActGILTIFDIIAndBEATProvisionsPercent',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActGILTIFDIIAndBEATProvisionsPercent',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActof2017ForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationTaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationTaxForeignDerivedIntangibleIncomeDeduction',
'EffectiveIncomeTaxReconciliationFDIIDeduction',
'EffectiveIncometaxReconciliationForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxReconciliationForeignDerivedIntangibleIncome',
'EffectiveIncomeTaxReconciliationForeignDerivedIntangibleIncomeAmount',
'EffectiveIncomeTaxReconciliationForeignDerivedIntangibleIncomeDeduction',
'EffectiveIncomeTaxReconciliationForeignDerivedIntangibleIncomePercent',
'EffectiveIncomeTaxReconciliationForeignDerivedIntangibleIncomeTaxAmount',
'EffectiveIncomeTaxReconciliationForeignDerivedIntangibleIncomeTaxRate',
'EffectiveIncomeTaxReconciliationTaxBenefitRelatedToForeignDerivedIntangibleIncomeDeduction',
'EffectiveratereconciliationFDII',
'EffectiveTaxRateReconciliationChangeForFDIIProvision',
'EffectiveTaxRateReconciliationForeignDerivedIntangibleIncomeDeduction',
'EffectiveTaxRateReconciliationForeignderivedintangibleincomedeductionPercent',
'EffectiveTaxRateReconciliationIncreaseinForeignDerivedIntangibleIncome',
'EstimatedAnnualizedTaxDeductionForFDII',
'EstimatedForeignderivedIntangibleIncomeDeduction',
'EstimatedIncrementalUnitedStatesTaxSavingsOnForeignDerivedIntangibleIncome',
'EstimatedTaxBenefitAssociatedWithForeignDerivedIntangibleIncome',
'FDIIDeductionForTaxReform',
'FDIIIncomeTaxExpenseBenefit',
'FederalStatutoryIncomeTaxRateDeductionOnForeignDerivedIntangibleIncome',
'Foreignderivedintangibleincome',
'Foreignderivedintangibleincomededuction',
'ForeignderivedIntangibleIncomeDeduction',
'ForeignDerivedIntangibleIncomeDeduction',
'ForeignDerivedIntangibleIncomeDeductionAmount',
'ForeignderivedIntangibleIncomeDeductionIncomeTaxExpenseBenefit',
'ForeignDerivedIntangibleIncomeDeductionIncomeTaxExpenseBenefit',
'ForeignDerivedIntangibleIncomeDeductionLimitPercent',
'ForeignderivedIntangibleIncomeDeductionPercent',
'ForeignDerivedIntangibleIncomeFdii',
'ForeignDerivedIntangibleIncomeFDII',
'ForeignDerivedIntangibleIncomeFDIIEffectiveTaxRate',
'ForeignDerivedIntangibleIncomeImpactDeductionOfIncomeTaxExpense',
'ForeignDerivedIntangibleIncomeTaxCredit',
'ForeignDerivedIntangibleIncomeTaxDeduction',
'ForeignDerivedIntangibleIncomeTaxExpenseBenefit',
'IncomeTaxBenefitRelatedToInitialApplicationToForeignDerivedIntangibleIncome',
'IncomeTaxExpenseBenefitContinuingOperationsForeignDerivedIntangibleIncome',
'IncomeTaxExpenseBenefitForeignDerivedIntangibleIncome',
'IncomeTaxExpenseBenefitFromForeignDerivedIntangibleIncomeProvisions',
'IncomeTaxRateReconciliationDeductionForeignDerivedIntangibleIncome',
'IncomeTaxRateReconciliationGILTIFDIIAndBEATAmount',
'IncomeTaxReconciliationChangeInForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationDeduction_FDII',
'IncomeTaxReconciliationDeductionForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationDeductionsFDII',
'IncomeTaxReconciliationDeductionsFDIIPercent',
'IncomeTaxReconciliationDeductionsForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationFDIIDeduction',
'IncomeTaxReconciliationFDIIGILTIAndOtherProvisions',
'Incometaxreconciliationforeignderivedintangibleincome',
'IncomeTaxReconciliationForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationForeignDerivedIntangibleIncomeBenefit',
'IncomeTaxReconciliationForeignDerivedIntangibleIncomeDeduction',
'IncomeTaxReconciliationForeignDerivedIntangibleIncomeDeductionAmount',
'IncomeTaxReconciliationForeignDerivedIntangibleIncomeFDIIAmount',
'IncomeTaxReconciliationGiltiFdii',
'IncomeTaxReconciliationGlobalIntangibleLowTaxIncomeAndForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationIncomeTaxExpenseBenefitAtForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationNetEffectGiltiAndFdii',
'IncomeTaxReconciliationNondeductibleBenefitForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationNondeductibleExpenseBenefitForeignDerivedIntangibleIncome',
'IncomeTaxReconciliationSection250ForeignDerivedIntangibleIncomeDeduction',
'IncrementalPercentagePointsRelatedToForeignDerivedIntangibleIncomeFDIIAndCapitalizationOfRDBenefit',
'NetTaxBenefitFromForeignDerivedIntangibleIncome',
'PercentageOfDecreaseInTaxCutsAndJobsActOf2017IncompleteAccountingForeignDerivedIntangibleIncome',
'PercentageOfForeignDerivedIntangibleIncomeDeduction',
'PercentageOfForeignDerivedIntangibleIncomeRelatedToFavorableImpactOnPriorYearsFromFinalRegulations',
'ReductionInIncomeTaxExpenseForFDII',
'TaxBenefitFromOurForeignDerivedIntangibleIncome',
'TaxCutsandJobsActAccountingCompleteIncomeTaxExpenseBenefitForeignDerivedIntangibleIncome',
'TaxCutsandJobsActForeignDerivedIntangibleIncomeDeductionBenefit',
'TaxCutsAndJobsActForeignDerivedIntangibleIncomeIncomeTaxExpenseBenefit',
'TaxCutsAndJobsActGlobalIntangibleLowTaxedIncomeAndForeignDerivedIntangibleIncomeIncomeTaxExpenseBenefit',
'TaxCutsAndJobsActIncomeTaxExpenseBenefitForeignDerivedIntangibleIncome',
'TaxCutsandJobsActIncompleteAccountingForeignDerivedIntangibleIncomeProvisionalIncomeTaxExpenseBenefit',
'TaxCutsAndJobsActOf2017ChangeInTaxRateIncomeTaxBenefitOnForeignDerivedIntangibleIncome',
'TaxCutsAndJobsActOf2017DeferredTaxAssetsUndistributedForeignEarningsForeignDerivedIntangibleIncomeFDII',
'TaxCutsAndJobsActOf2017DeferredTaxAssetsUndistributedForeignEarningsGlobalIntangibleLowTaxedIncomeAndForeignDerivedIntangibleIncomeGILTIFDII',
'TaxCutsAndJobsActOf2017DeferredTaxLiabilitiesUndistributedForeignEarningsGlobalIntangibleLowTaxedIncomeGILTIFDIIAndBEAT',
'TaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeDeduction',
'TaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeDeductionBenefit',
'TaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeDeductionIncomeTaxBenefitExpense',
'TaxCutsAndJobsActof2017ForeignDerivedIntangibleIncomeExpenseBenefit',
'TaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeIncomeTaxExpenseBenefit',
'TaxCutsAndJobsActOf2017ForeignDerivedIntangibleIncomeProvisionalTax',
'TaxCutsandJobsActof2017GILTIandFDII',
'TaxCutsAndJobsActOf2017GILTIProvisionalIncomeTaxExpenseNetOfFDII',
'TaxCutsAndJobsActOf2017IncompleteAccountingDecreaseInEffectiveTaxRateAsResultOfForeignDerivedIntangibleIncomeProvision',
'TaxCutsAndJobsActOf2017IncompleteAccountingDecreaseInEffectiveTaxRateFromContinuingOperationsAsResultOfForeignDerivedIntangibleIncomeProvision',
'TaxCutsAndJobsActOf2017IncompleteAccountingDecreaseInEffectiveTaxRateFromDiscontinuedOperationsAsResultOfForeignDerivedIntangibleIncomeProvision',
'TaxCutsAndJobsActOf2017IncompleteAccountingGILTIProvisionalIncomeTaxExpenseNetOfFDII',
'TaxEffectOfUnitedStatesForeignDerivedIntangibleIncomeDeduction',
'TaxonforeignearningsU.S.TaxLegislationGILTIandFDII',
'TaxonforeignearningsU.S.taxreformGILTIandFDII',
'U.S.deductionforforeignderivedintangibleincome',
'UsGaap_EffectiveIncomeTaxRateReconciliationForeignDerivedIntangibleIncome',
'U.S.taxreformimpactGILTIandFDII',
'EffectiveIncomeTaxRateReconciliationBenefitOfForeignIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationDeductionForeignIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationDeductionForeignIntangibleIncomeDeductionAmount',
'EffectiveIncomeTaxRateReconciliationDeductionForeignIntangibleIncomePercent',
'EffectiveIncomeTaxRateReconciliationForeignIntangibleIncome',
'EffectiveIncomeTaxRateReconciliationForeignIntangibleIncomeAmount',
'EffectiveIncomeTaxRateReconciliationForeignIntangibleIncomeDeductionPercent',
'EffectiveIncomeTaxRateReconciliationForeignIntangibleIncomePercent',
'TaxCutsAndJobsActIncomeTaxExpenseBenefitForeignIntangibleIncome')

assert US.0154.9881  satisfied
$ruleId = (rule-name().split('.'))[rule-name().split('.').length];

/** Find the network where taxes are by looking for the disclosure presentation network that contains the following:
IncomeTaxReconciliationIncomeTaxExpenseBenefitAtFederalStatutoryIncomeTaxRate
EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate
IncomeTaxExpenseBenefit
EffectiveIncomeTaxRateContinuingOperations
**/

$IncomeTaxElements = set(IncomeTaxReconciliationIncomeTaxExpenseBenefitAtFederalStatutoryIncomeTaxRate,
EffectiveIncomeTaxRateReconciliationAtFederalStatutoryIncomeTaxRate,
IncomeTaxExpenseBenefit,
EffectiveIncomeTaxRateContinuingOperations);

$incomeTaxNetworks = FILTER $PRES_NETWORKS where $item.role.description.contains('- Disclosure -') and (($item.concept-names).to-set intersect $IncomeTaxElements).length > 0

for $incomeTaxNetwork in $incomeTaxNetworks.sort
    $incomeTaxConcepts =  $incomeTaxNetwork.concepts;
    $incomeTaxRelationships = $incomeTaxNetwork.relationships
    $preferredLabels = (filter $incomeTaxRelationships returns $item.preferred-label).to-set
    for $x in (filter $incomeTaxConcepts where $item.is-numeric returns $item.name)
        for $labelRole in $preferredLabels
            $label = taxonomy().concept($x).label($labelRole).text
            if ($label.lower-case.contains('fdii') or $label.lower-case.contains('foreign-derived intangible income') or $label.lower-case.contains('foreign derived intangible income')) and $x not in list(EffectiveIncomeTaxRateReconciliationFdiiPercent, EffectiveIncomeTaxRateReconciliationFdiiAmount)
                true
            else
                false


message
"The filer has reported a value for foreign-derived intangible income that is not using the element defined in the US-GAAP taxonomy.  The FASB has added elements for the FDII percntage amount and the FDII monetary amount in the 2022 taxonomy.  These elements are:

1. EffectiveIncomeTaxRateReconciliationFdiiPercent
2. EffectiveIncomeTaxRateReconciliationFdiiAmount

The  element {$x}  with the label \"{$label}\" has been used in the filing in the disclosure section \"{$incomeTaxNetwork.role.description}\" that should be updated to the appropriate  US-GAAP element listed above.

Rule Element Id:{$ruleId}
Rule version: {$ruleVersion}
"